[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:redis]
command=redis-server /etc/redis/redis.conf
autostart=true
autorestart=true
user=redis
stdout_logfile=/var/log/redis/redis-stdout.log
stderr_logfile=/var/log/redis/redis-stderr.log
priority=1

[program:archon-server]
command=python -m uvicorn src.server.main:socket_app --host 0.0.0.0 --port %(ENV_ARCHON_SERVER_PORT)s --workers 1
directory=/app
autostart=true
autorestart=true
stdout_logfile=/var/log/archon-server.log
stderr_logfile=/var/log/archon-server-error.log
environment=PYTHONPATH="/app:/root/.local/lib/python3.11/site-packages",PYTHONUNBUFFERED="1",REDIS_URL="redis://localhost:6379"
priority=10